
# mini Hi 系统设置项目总结

## 项目简介
来到百度两个月了，第一个接手的自己负责的小项目就是mini Hi的系统设置了。刚接手的时候，以为蛮容易做的，做完了，还是发现有些地方需要注意和总结一下的。

## 代码架构
在一个页面里面谈架构感觉有点夸张，但是这个设置页面还是相当复杂的。刚来的时候，导师告诉我了解一下riot框架，我了解了一下，但是怕没有经验使用不好，就没有使用。而是自己依照MVC的思想组织的代码。这个设置页面，很明显的是data驱动的页面，每一个设置项的显示，需要根据数据来渲染，每一个设置项的改动，都要同步到数据去更新。就是这样的模式，MVC，当然，MVVM也是很合适的。但是想着一个页面没必要用套框架就自己直接写了。事件的监听是一个类，每个方法监听每个设置项；数据的同步是一个类，这里负责在设置项改变后去改变数据；渲染是另一个类，读取数据，据此把相应的选项设置好。

## 经验教训
在这个设置页面的开发过程中，还是遇到几个问题的：
###1 快速自定义控件能力欠缺
因为这个页面的引擎是Chromium，因为mini Hi 客户端集成内核的某些问题，导致引擎在渲染下拉列表的时候，出现问题：只要点击并展开了下拉列表，再拖动窗口，展开的列表项并不会跟随窗口拖动，而是会呆在原地。经确认，这是内核级的问题，然而客户端并没有相应的借口去重新渲染，因而只能让FE这边解决，那么就要重新自定义控件了。一个下拉列表，看起来很容易，也确实不难，但是其绑定的事件还是有好几个的：比如点击展开，鼠标滑过，点击非控件区域需要隐藏，以及从隐藏的原始的select读值和赋值等。我在做这个控件的时候，看了下之前的自定义控件，感觉代码风格和结构不符合我的要求，便自己做了处理，所以有些问题没想到，导致后来又进行了修改，没能实现自定义控件的快速开发，耽搁了些时间。
###2 问题定位不够快速
在开发过程中，遇到了一个自定义下拉列表鼠标经过无效的问题。对于这个问题，首先想到的还是定位方法导致浏览器不渲染此区域，但是找不到方法解决；再因为内核问题的前车之鉴，想到是内核级的问题，也不是；直到最后发现是被一个透明的元素层遮盖了，它先一步捕获了鼠标事件。这个问题其实是个很简单的问题，但是因为那个元素是透明的无法看到，并且是绝对定位，代码并不在相应的位置，所以找起来还是走了些弯路。
###3 缺乏测试环境
由于这个页面的开发是用的hybrid模式，是嵌入到C++的客户端里面运行的web页面，因此，无法使用console，有时只能alert一下，也没有数据测试环境，因为并不太好模拟。我在想，可以自己实现一个简单的log工具，一个半透明层，直接在运行的时候打印log，方便开发测试。
## 总结
经过这第一个项目的实践，熟悉了百度的开发流程，代码提交流程，联合调试流程等等，也懂得一些自己在开发过程中值得改进和提高的地方。